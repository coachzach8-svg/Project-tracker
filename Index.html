<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Project Tracker</title>
  <meta name="theme-color" content="#111827" />
  <style>
    :root { --bg:#0b1220; --card:#111a2e; --muted:#9aa4b2; --text:#e6e9ef; --accent:#60a5fa; --danger:#fb7185; --ok:#34d399; }
    *{box-sizing:border-box} body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;background:linear-gradient(180deg,#070b14,#0b1220 40%);color:var(--text)}
    .wrap{max-width:860px;margin:0 auto;padding:16px 14px 90px}
    header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin:10px 0 14px}
    h1{font-size:18px;margin:0;letter-spacing:.2px}
    .pill{font-size:12px;color:var(--muted);padding:6px 10px;border:1px solid rgba(255,255,255,.08);border-radius:999px;background:rgba(255,255,255,.03)}
    .card{background:rgba(17,26,46,.85);border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:12px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
    .row{display:flex;gap:10px;flex-wrap:wrap}
    .grow{flex:1 1 220px}
    input, select, textarea{width:100%;background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.10);color:var(--text);
      padding:10px 12px;border-radius:12px;outline:none}
    textarea{min-height:110px;resize:vertical}
    label{font-size:12px;color:var(--muted);display:block;margin:8px 0 6px}
    button{border:0;border-radius:12px;padding:10px 12px;font-weight:600;color:#06101f;background:var(--accent);cursor:pointer}
    button.secondary{background:rgba(255,255,255,.08);color:var(--text)}
    button.danger{background:rgba(251,113,133,.18);color:#ffd7df;border:1px solid rgba(251,113,133,.35)}
    button:active{transform:translateY(1px)}
    .chips{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
    .chip{padding:7px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.10);background:rgba(255,255,255,.03);color:var(--text);font-size:12px;cursor:pointer}
    .chip.active{border-color:rgba(96,165,250,.55);background:rgba(96,165,250,.15)}
    .list{margin-top:12px;display:grid;gap:10px}
    .item{display:flex;gap:10px;align-items:flex-start;justify-content:space-between;padding:12px;border-radius:16px;border:1px solid rgba(255,255,255,.08);
      background:rgba(255,255,255,.03)}
    .item h3{margin:0 0 4px;font-size:15px}
    .meta{font-size:12px;color:var(--muted)}
    .status{font-size:11px;padding:6px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.03)}
    .status.ACTIVE{border-color:rgba(96,165,250,.45);background:rgba(96,165,250,.12)}
    .status.IDEA{border-color:rgba(250,204,21,.35);background:rgba(250,204,21,.10)}
    .status.WAITING{border-color:rgba(167,139,250,.35);background:rgba(167,139,250,.10)}
    .status.DONE{border-color:rgba(52,211,153,.35);background:rgba(52,211,153,.10)}
    .actions{display:flex;gap:8px;align-items:center}
    .small{padding:8px 10px;border-radius:12px;font-size:12px}
    .footerbar{position:fixed;left:0;right:0;bottom:0;background:rgba(8,13,24,.92);backdrop-filter:blur(8px);
      border-top:1px solid rgba(255,255,255,.08);padding:10px 14px}
    .footerinner{max-width:860px;margin:0 auto;display:flex;gap:10px;align-items:center;justify-content:space-between}
    .hint{color:var(--muted);font-size:12px}
    .link{color:var(--accent);text-decoration:none}
    .two{display:grid;grid-template-columns:1fr;gap:12px}
    @media (min-width:820px){ .two{grid-template-columns:1fr 1fr} }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Project Tracker</h1>
        <div class="pill" id="countPill">0 projects</div>
      </div>
      <button class="secondary small" id="exportBtn" title="Export your data">Export</button>
    </header>

    <div class="two">
      <section class="card">
        <h2 style="margin:0 0 8px;font-size:14px;color:var(--muted);font-weight:700;letter-spacing:.2px">Add / Edit</h2>

        <input type="hidden" id="editingId" value="" />

        <label>Project name</label>
        <input id="name" placeholder="e.g., Storage office signage refresh" />

        <div class="row">
          <div class="grow">
            <label>Status</label>
            <select id="status">
              <option value="ACTIVE">ACTIVE</option>
              <option value="IDEA">IDEA</option>
              <option value="WAITING">WAITING</option>
              <option value="DONE">DONE</option>
            </select>
          </div>
          <div class="grow">
            <label>Tags (comma-separated)</label>
            <input id="tags" placeholder="e.g., work, personal, fitness" />
          </div>
        </div>

        <label>Notes</label>
        <textarea id="notes" placeholder="Keep it simple. Bullet points work."></textarea>

        <div class="row" style="margin-top:10px">
          <button id="saveBtn" class="grow">Save Project</button>
          <button id="clearBtn" class="secondary">Clear</button>
        </div>
      </section>

      <section class="card">
        <h2 style="margin:0 0 8px;font-size:14px;color:var(--muted);font-weight:700;letter-spacing:.2px">Find</h2>

        <label>Search</label>
        <input id="query" placeholder="Search name, notes, tags…" />

        <div class="chips" id="filterChips"></div>

        <div class="list" id="list"></div>
      </section>
    </div>
  </div>

  <div class="footerbar">
    <div class="footerinner">
      <div class="hint">
        Data stays on this device (local storage). Tip: add to home screen for “app mode”.
      </div>
      <button class="danger small" id="wipeBtn" title="Deletes everything">Wipe</button>
    </div>
  </div>

<script>
  const STORAGE_KEY = "project_tracker_v1";

  const $ = (id) => document.getElementById(id);
  const nameEl = $("name");
  const statusEl = $("status");
  const tagsEl = $("tags");
  const notesEl = $("notes");
  const queryEl = $("query");
  const listEl = $("list");
  const editingIdEl = $("editingId");
  const countPillEl = $("countPill");
  const filterChipsEl = $("filterChips");

  const STATUSES = ["ALL", "ACTIVE", "IDEA", "WAITING", "DONE"];
  let activeFilter = "ALL";

  function load() {
    try {
      return JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");
    } catch {
      return [];
    }
  }

  function save(projects) {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(projects));
  }

  function uid() {
    return Math.random().toString(16).slice(2) + Date.now().toString(16);
  }

  function now() {
    return Date.now();
  }

  function normalizeTags(s) {
    return (s || "")
      .split(",")
      .map(t => t.trim())
      .filter(Boolean);
  }

  function formatTime(ms) {
    const d = new Date(ms);
    return d.toLocaleString();
  }

  function resetForm() {
    editingIdEl.value = "";
    nameEl.value = "";
    statusEl.value = "ACTIVE";
    tagsEl.value = "";
    notesEl.value = "";
    nameEl.focus();
  }

  function setEditing(p) {
    editingIdEl.value = p.id;
    nameEl.value = p.name;
    statusEl.value = p.status;
    tagsEl.value = (p.tags || []).join(", ");
    notesEl.value = p.notes || "";
    window.scrollTo({ top: 0, behavior: "smooth" });
  }

  function upsertProject() {
    const projects = load();
    const id = editingIdEl.value || uid();
    const name = nameEl.value.trim();
    if (!name) { alert("Give it a name."); return; }

    const status = statusEl.value;
    const tags = normalizeTags(tagsEl.value);
    const notes = notesEl.value;

    const existingIndex = projects.findIndex(p => p.id === id);
    const base = existingIndex >= 0 ? projects[existingIndex] : { id, createdAt: now() };

    const updated = {
      ...base,
      name,
      status,
      tags,
      notes,
      updatedAt: now()
    };

    if (existingIndex >= 0) projects[existingIndex] = updated;
    else projects.unshift(updated);

    save(projects);
    resetForm();
    render();
  }

  function deleteProject(id) {
    const projects = load().filter(p => p.id !== id);
    save(projects);
    render();
  }

  function cycleStatus(id) {
    const projects = load();
    const i = projects.findIndex(p => p.id === id);
    if (i < 0) return;
    const order = ["IDEA","ACTIVE","WAITING","DONE"];
    const cur = projects[i].status || "ACTIVE";
    const next = order[(order.indexOf(cur) + 1) % order.length];
    projects[i] = { ...projects[i], status: next, updatedAt: now() };
    save(projects);
    render();
  }

  function wipeAll() {
    if (!confirm("Wipe EVERYTHING? This can’t be undone.")) return;
    localStorage.removeItem(STORAGE_KEY);
    resetForm();
    render();
  }

  function exportData() {
    const projects = load();
    const blob = new Blob([JSON.stringify({ exportedAt: now(), projects }, null, 2)], { type: "application/json" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "project-tracker-export.json";
    document.body.appendChild(a);
    a.click();
    a.remove();
    URL.revokeObjectURL(url);
  }

  function matchesQuery(p, q) {
    if (!q) return true;
    q = q.toLowerCase();
    const hay = [
      p.name || "",
      p.notes || "",
      (p.tags || []).join(" ")
    ].join(" ").toLowerCase();
    return hay.includes(q);
  }

  function renderChips() {
    filterChipsEl.innerHTML = "";
    STATUSES.forEach(s => {
      const chip = document.createElement("button");
      chip.className = "chip" + (activeFilter === s ? " active" : "");
      chip.textContent = s;
      chip.onclick = () => { activeFilter = s; render(); };
      filterChipsEl.appendChild(chip);
    });
  }

  function render() {
    const projects = load().sort((a,b) => (b.updatedAt||0) - (a.updatedAt||0));
    const q = queryEl.value.trim();

    const filtered = projects
      .filter(p => activeFilter === "ALL" ? true : p.status === activeFilter)
      .filter(p => matchesQuery(p, q));

    countPillEl.textContent = `${projects.length} project${projects.length === 1 ? "" : "s"}`;

    listEl.innerHTML = "";

    if (filtered.length === 0) {
      const empty = document.createElement("div");
      empty.className = "meta";
      empty.style.padding = "6px 2px";
      empty.textContent = projects.length === 0 ? "No projects yet. Add one on the left." : "No matches for your filter/search.";
      listEl.appendChild(empty);
      return;
    }

    filtered.forEach(p => {
      const item = document.createElement("div");
      item.className = "item";

      const left = document.createElement("div");
      left.style.flex = "1";

      const h = document.createElement("h3");
      h.textContent = p.name;

      const meta = document.createElement("div");
      meta.className = "meta";
      const tagText = (p.tags && p.tags.length) ? ` • tags: ${p.tags.join(", ")}` : "";
      meta.textContent = `Updated: ${formatTime(p.updatedAt || p.createdAt || now())}${tagText}`;

      const note = document.createElement("div");
      note.className = "meta";
      note.style.marginTop = "6px";
      note.textContent = (p.notes || "").trim() ? (p.notes.trim().slice(0, 110) + ((p.notes.trim().length > 110) ? "…" : "")) : "No notes";

      left.appendChild(h);
      left.appendChild(meta);
      left.appendChild(note);

      const right = document.createElement("div");
      right.style.display = "flex";
      right.style.flexDirection = "column";
      right.style.gap = "8px";
      right.style.alignItems = "flex-end";

      const status = document.createElement("div");
      status.className = `status ${p.status || "ACTIVE"}`;
      status.textContent = p.status || "ACTIVE";
      status.title = "Tap to cycle status";
      status.style.cursor = "pointer";
      status.onclick = () => cycleStatus(p.id);

      const actions = document.createElement("div");
      actions.className = "actions";

      const editBtn = document.createElement("button");
      editBtn.className = "secondary small";
      editBtn.textContent = "Edit";
      editBtn.onclick = () => setEditing(p);

      const delBtn = document.createElement("button");
      delBtn.className = "danger small";
      delBtn.textContent = "Delete";
      delBtn.onclick = () => {
        if (confirm(`Delete "${p.name}"?`)) deleteProject(p.id);
      };

      actions.appendChild(editBtn);
      actions.appendChild(delBtn);

      right.appendChild(status);
      right.appendChild(actions);

      item.appendChild(left);
      item.appendChild(right);

      listEl.appendChild(item);
    });
  }

  // wire up
  $("saveBtn").onclick = upsertProject;
  $("clearBtn").onclick = resetForm;
  $("wipeBtn").onclick = wipeAll;
  $("exportBtn").onclick = exportData;
  queryEl.addEventListener("input", render);

  renderChips();
  render();
</script>
</body>
</html>
